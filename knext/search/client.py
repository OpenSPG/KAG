# Copyright 2023 OpenSPG Authors
#
# Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
# in compliance with the License. You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software distributed under the License
# is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
# or implied.

from knext.common.base.client import Client
from knext.common.rest import Configuration, ApiClient

from knext.search import rest, TextSearchRequest, VectorSearchRequest, IdxRecord


def idx_record_to_dict(record: IdxRecord):
    return {"score": record.score, "node": record.fields}


class SearchClient(Client):
    """ """

    def __init__(self, host_addr: str = None, project_id: int = None):
        super().__init__(host_addr, project_id)
        self._rest_client: rest.SearchApi = rest.SearchApi(
            api_client=ApiClient(configuration=Configuration(host=host_addr))
        )

    def search_text(self, query_string, label_constraints=None, topk=10, params=None):
        req = TextSearchRequest(
            self._project_id, query_string, label_constraints, topk, params
        )
        records = self._rest_client.search_text_post(text_search_request=req)
        return [idx_record_to_dict(record) for record in records]

    def search_vector(
        self, label, property_key, query_vector, topk=10, ef_search=None, params=None
    ):
        req = VectorSearchRequest(
            self._project_id, label, property_key, query_vector, ef_search, topk, params
        )
        records = self._rest_client.search_vector_post(vector_search_request=req)
        return [idx_record_to_dict(record) for record in records]


if __name__ == "__main__":
    sc = SearchClient("https://spgservice-standard-pre.alipay.com", -2851051637302220990)
    # a = sc.search_text("Depressive_or_psychotic_symptoms")
    # print(a)

    b = sc.search_vector(
        label="MedQA.ChunkQuery",
        property_key="name",
        query_vector=[-0.032684326171875, -0.00550079345703125, -0.0516357421875, -0.03997802734375, -0.0302276611328125, -0.00965118408203125, 0.039154052734375, 0.0143280029296875, -0.010589599609375, -0.0343017578125, 0.021514892578125, 0.04339599609375, -0.0188751220703125, 0.0124053955078125, 0.0085601806640625, -0.00799560546875, 0.0009284019470214844, -0.004245758056640625, -0.055908203125, 0.0298004150390625, -0.03955078125, -0.0130767822265625, -0.03302001953125, -0.003387451171875, 0.008026123046875, 0.042022705078125, 0.017242431640625, -0.06329345703125, -0.00337982177734375, -0.0201568603515625, 0.015960693359375, -0.06719970703125, 0.0033779144287109375, -0.0069122314453125, 0.0005507469177246094, 0.0191192626953125, -0.013427734375, 0.006900787353515625, -0.034027099609375, 0.035247802734375, 0.0010528564453125, -0.005035400390625, 0.006053924560546875, -0.0031719207763671875, 0.004596710205078125, -0.06707763671875, -0.035491943359375, -0.0214080810546875, -0.006622314453125, 0.004627227783203125, 0.00412750244140625, 0.006587982177734375, 0.0170745849609375, -0.01488494873046875, 0.013427734375, 0.0226593017578125, -0.0111541748046875, 0.021636962890625, -0.0667724609375, -0.027435302734375, 0.00502777099609375, 0.04620361328125, -0.02325439453125, -0.02685546875, -0.000640869140625, 0.044281005859375, 0.0159454345703125, 0.0088653564453125, -0.03070068359375, 0.0404052734375, -0.017333984375, 0.0115203857421875, 0.0350341796875, -0.0150299072265625, -0.02545166015625, 0.01403045654296875, -0.01325225830078125, -0.011444091796875, -0.0006089210510253906, 0.041168212890625, -0.019317626953125, -0.01096343994140625, 0.025299072265625, 0.018463134765625, -0.0007100105285644531, 0.035400390625, 0.0303955078125, 0.0006299018859863281, -0.00714874267578125, -0.044219970703125, -0.00849151611328125, -0.0037364959716796875, -0.0119781494140625, 0.01270294189453125, -0.01280975341796875, 0.00311279296875, -0.0677490234375, -0.036865234375, 0.032806396484375, -0.013702392578125, 0.0178070068359375, 0.01403045654296875, 0.006763458251953125, -0.01311492919921875, 0.0220184326171875, -0.0367431640625, 0.00614166259765625, 0.0104522705078125, 0.062286376953125, -0.01317596435546875, 0.0231475830078125, 0.0105743408203125, 0.00611114501953125, 0.01511383056640625, -0.008575439453125, -0.00673675537109375, 0.007396697998046875, -0.056060791015625, 0.0244598388671875, -0.00391387939453125, -0.012908935546875, 0.040252685546875, -0.0360107421875, -0.037841796875, -0.0264129638671875, 0.05218505859375, 0.072265625, -0.038055419921875, -0.00027251243591308594, 0.0182647705078125, -0.003940582275390625, 0.0005002021789550781, -0.0670166015625, -0.001056671142578125, -0.003887176513671875, -0.0098114013671875, 0.034027099609375, 0.0537109375, 0.01611328125, -0.02386474609375, 0.0103912353515625, 0.053070068359375, 0.026519775390625, -0.027557373046875, 0.046142578125, -0.0709228515625, -0.037750244140625, 0.006649017333984375, 0.046783447265625, 0.0086517333984375, -0.0013284683227539062, -0.019134521484375, -0.002933502197265625, 0.04620361328125, -0.052703857421875, -0.037261962890625, -0.002628326416015625, 0.022674560546875, 0.0173797607421875, -0.0137481689453125, 0.07379150390625, 0.052154541015625, 0.032073974609375, 0.00780487060546875, 0.026336669921875, 0.01079559326171875, 0.06781005859375, 0.0264129638671875, -0.02264404296875, -0.0159454345703125, 0.0190277099609375, -0.0693359375, -0.04595947265625, -0.01137542724609375, -0.01551055908203125, 0.00241851806640625, 0.057891845703125, 0.0086669921875, 0.035491943359375, -0.0228424072265625, 0.00995635986328125, -0.005466461181640625, 0.033203125, 0.0164031982421875, -0.0024623870849609375, 0.01338958740234375, -0.03466796875, 0.015106201171875, 0.005489349365234375, 0.03509521484375, -0.01299285888671875, -0.046417236328125, 0.01407623291015625, -0.0155792236328125, -0.019622802734375, -0.03460693359375, -0.037811279296875, -0.0119781494140625, -0.01360321044921875, 0.0201263427734375, 0.0279083251953125, 0.032440185546875, 0.00010210275650024414, 0.0226287841796875, 0.0018033981323242188, -0.00868988037109375, -0.0292510986328125, -0.0254669189453125, 0.03558349609375, -0.022003173828125, 0.006587982177734375, 0.007537841796875, -0.0374755859375, -0.054931640625, -0.016754150390625, -0.055328369140625, 0.03515625, -0.0223541259765625, -0.00911712646484375, 0.003986358642578125, 0.002735137939453125, 0.035888671875, 0.03643798828125, -0.0721435546875, 0.0435791015625, -0.0263214111328125, 0.0009150505065917969, -0.0330810546875, -0.0234222412109375, -0.048583984375, -0.00849151611328125, 0.034454345703125, -0.0286865234375, -0.00959014892578125, 0.0771484375, 0.021636962890625, 0.03936767578125, -0.0069580078125, 0.0193939208984375, 0.042724609375, -0.02178955078125, -0.043182373046875, 0.0594482421875, 0.02374267578125, -0.007556915283203125, -0.02459716796875, 0.06689453125, 0.0540771484375, -0.05645751953125, 0.0135650634765625, -0.002223968505859375, -0.01383209228515625, -0.00415802001953125, 0.0224151611328125, 0.0008940696716308594, -0.036346435546875, 0.016204833984375, 0.00817108154296875, -0.0118408203125, 0.0002168416976928711, 0.0266265869140625, 0.0272369384765625, 0.0007672309875488281, 0.01068878173828125, 0.0029811859130859375, -0.01519775390625, 0.0010557174682617188, -0.015899658203125, 0.06317138671875, -0.02978515625, -0.03277587890625, 0.00782012939453125, -0.00951385498046875, -0.0011587142944335938, 0.019989013671875, -0.00791168212890625, -0.01122283935546875, 0.0027675628662109375, 0.033966064453125, -0.0171661376953125, -0.0281829833984375, 0.0210113525390625, 0.004642486572265625, -0.0218658447265625, -0.0379638671875, -0.06280517578125, -0.0736083984375, 0.026275634765625, -0.0219573974609375, 0.00821685791015625, 0.023773193359375, 0.0276947021484375, 0.04083251953125, 0.01381683349609375, -0.0304107666015625, -0.005481719970703125, 0.008697509765625, -0.1461181640625, 0.03448486328125, -0.01038360595703125, 0.0260772705078125, -0.00562286376953125, 0.03662109375, -0.017333984375, -0.045684814453125, -0.0166015625, -0.1248779296875, -0.0021820068359375, -0.049530029296875, -0.054718017578125, 0.0028629302978515625, -0.0026073455810546875, 0.01500701904296875, -0.0199737548828125, -0.056640625, -0.01166534423828125, -0.0114898681640625, -0.01053619384765625, 0.0226593017578125, -0.0139923095703125, -0.0054931640625, 0.00021064281463623047, -0.0131683349609375, 0.029510498046875, -0.0196380615234375, 0.00444793701171875, -0.0123138427734375, -0.0010900497436523438, -0.004913330078125, -0.00942230224609375, 0.039154052734375, 0.006496429443359375, -0.0281524658203125, 0.0318603515625, -0.03497314453125, 0.01488494873046875, 0.00960540771484375, 0.00907135009765625, 0.054107666015625, 0.0163421630859375, 0.04058837890625, -0.032623291015625, -0.0714111328125, 0.0108184814453125, -0.0009708404541015625, -0.018707275390625, -0.007354736328125, 0.030242919921875, -0.041656494140625, -0.03338623046875, 0.052276611328125, -0.04815673828125, 0.0116119384765625, 0.0298614501953125, 0.040130615234375, 0.0174102783203125, -0.00908660888671875, -0.041015625, -0.06292724609375, 0.0155029296875, -0.038360595703125, -0.029541015625, 0.0055389404296875, 0.0126953125, -0.0200042724609375, 0.01580810546875, -0.03570556640625, 0.02264404296875, 0.04022216796875, 0.03277587890625, 0.0239105224609375, 0.0562744140625, 0.027008056640625, -0.0187835693359375, 0.0138702392578125, -0.00850677490234375, -0.08709716796875, -0.0112762451171875, 0.045074462890625, 0.0196075439453125, 0.024871826171875, -0.0306396484375, -0.0218505859375, 0.00951385498046875, -0.01071929931640625, -0.052032470703125, 0.2371826171875, 0.052520751953125, 0.045074462890625, 0.0228271484375, -0.03472900390625, -0.00038552284240722656, -0.01042938232421875, 0.0098114013671875, -0.03033447265625, -0.0205078125, 0.026275634765625, -0.0310821533203125, 0.00798797607421875, -0.045989990234375, 0.0036220550537109375, 0.0101165771484375, -0.044464111328125, 0.009033203125, 0.059417724609375, -0.0033817291259765625, 0.0177764892578125, 0.0070648193359375, 0.0355224609375, -0.00469970703125, 0.004375457763671875, -0.034576416015625, 0.0025787353515625, 0.040313720703125, 0.0209197998046875, 0.033050537109375, -0.0141143798828125, -0.0052032470703125, 0.0275421142578125, -0.010101318359375, -0.047454833984375, -0.0279083251953125, 0.01824951171875, -0.017852783203125, -0.022125244140625, 0.0002684593200683594, 0.0293731689453125, -0.0278778076171875, -0.0791015625, 0.00656890869140625, -0.0005359649658203125, -0.038909912109375, -0.01236724853515625, 0.01479339599609375, 0.01457977294921875, -0.01511383056640625, -0.00348663330078125, 0.0190277099609375, -0.0008425712585449219, -0.0027790069580078125, 0.0106353759765625, 0.0088653564453125, -0.028411865234375, -0.02978515625, -0.03265380859375, -0.0155029296875, 0.007244110107421875, 0.0149383544921875, -0.03948974609375, 0.004878997802734375, -0.003665924072265625, 0.0430908203125, -0.01016998291015625, 0.03656005859375, -0.03973388671875, -0.0163116455078125, -0.00830841064453125, -0.04095458984375, -0.032073974609375, 0.0009613037109375, 0.05230712890625, 0.017578125, -0.038330078125, -0.01074981689453125, 0.025390625, 0.059783935546875, -0.0208282470703125, -0.01312255859375, 0.00402069091796875, -0.01457977294921875, 0.0255584716796875, 0.0198211669921875, 0.040130615234375, -0.0178070068359375, -0.0164337158203125, -0.002105712890625, 0.0265350341796875, 0.01264190673828125, -0.06927490234375, -0.01445770263671875, 0.0206756591796875, -0.0213775634765625, 0.0087738037109375, -0.0276336669921875, -0.032135009765625, 0.0185089111328125, 0.038238525390625, -0.019134521484375, -0.021026611328125, -0.01241302490234375, -0.003376007080078125, 0.005859375, -0.0302886962890625, 0.034027099609375, -0.034332275390625, -0.0285797119140625, -0.01474761962890625, 0.0206756591796875, 0.023681640625, -0.01384735107421875, -0.031463623046875, 0.040618896484375, -0.0280609130859375, -0.0005764961242675781, -0.00626373291015625, 0.050079345703125, -0.044403076171875, 0.0716552734375, -0.038970947265625, 0.017120361328125, -0.0104522705078125, -0.00258636474609375, -0.01288604736328125, 0.0007586479187011719, -0.039947509765625, 0.0340576171875, -0.0161590576171875, -0.0010776519775390625, -0.07080078125, 0.016845703125, 0.03729248046875, 0.004322052001953125, 0.0158233642578125, -0.00505828857421875, -0.01457977294921875, 0.04522705078125, 0.0236663818359375, 0.0005006790161132812, -0.028839111328125, -0.021209716796875, 0.01012420654296875, 0.011444091796875, -0.036376953125, -0.029205322265625, 0.023223876953125, 0.01448822021484375, 0.095703125, 0.0006909370422363281, -0.0304412841796875, -0.037567138671875, 0.0009436607360839844, 0.0355224609375, -0.031890869140625, 0.0117340087890625, 0.00807952880859375, 0.004528045654296875, 0.0213775634765625, 0.01141357421875, 0.0017690658569335938, 0.021942138671875, 0.0301971435546875, -0.0229644775390625, -0.003307342529296875, 0.01551055908203125, 0.027984619140625, 0.03204345703125, 0.0765380859375, 0.018157958984375, -0.044769287109375, 0.0008440017700195312, 0.046966552734375, 0.060302734375, -0.050445556640625, 0.0020084381103515625, -0.00412750244140625, 0.050750732421875, -0.031280517578125, -0.004634857177734375, 0.0147552490234375, 0.01026153564453125, 0.01204681396484375, 0.006565093994140625, 0.02093505859375, -0.03680419921875, 0.052001953125, -0.00921630859375, -0.03558349609375, 0.0670166015625, -0.0264892578125, -0.01385498046875, -0.01092529296875, 0.0200042724609375, 0.000614166259765625, 0.023681640625, 0.0088348388671875, -0.0079193115234375, 0.035400390625, -0.028564453125, 0.018585205078125, -5.137920379638672e-05, -0.06024169921875, 0.01003265380859375, -0.0654296875, 0.0258026123046875, -0.0263671875, 0.01145172119140625, 0.03607177734375, 0.04388427734375, -0.03955078125, -0.0036029815673828125, 0.008026123046875, 0.01509857177734375, 0.01373291015625, 0.0504150390625, -0.039764404296875, -0.0394287109375, 0.0007834434509277344, -0.0030460357666015625, 0.072021484375, -0.0187835693359375, -0.019287109375, 0.0291900634765625, -0.00531768798828125, -0.05755615234375, -0.01861572265625, 0.0228729248046875, 0.011444091796875, 0.004222869873046875, -0.03741455078125, -0.0289764404296875, 0.0053863525390625, -0.019622802734375, 0.016143798828125, 0.035552978515625, -0.05194091796875, -0.032440185546875, 0.03179931640625, -0.08770751953125, 0.0196533203125, 0.01511383056640625, 0.034027099609375, 0.0268707275390625, -0.01325225830078125, 0.0306549072265625, 0.0288238525390625, -0.0190582275390625, 0.0085601806640625, 0.037872314453125, 0.0197906494140625, -0.050445556640625, 0.01500701904296875, 0.018646240234375, -0.035186767578125, -0.006633758544921875, 0.005645751953125, 0.0256805419921875, 0.01165771484375, 0.001438140869140625, -0.004383087158203125, -0.0261077880859375, 0.029022216796875, -0.0053558349609375, 0.023590087890625, 0.04876708984375, 0.03424072265625, -0.0228118896484375, -0.0300140380859375, 0.001216888427734375, -0.036468505859375, -0.0289764404296875, -0.01210784912109375, -0.0172576904296875, -0.0225830078125, 0.03717041015625, 0.0299072265625, 0.00435638427734375, 0.0251617431640625, -0.0290069580078125, 0.05078125, 0.056243896484375, -0.0271759033203125, 0.03704833984375, 0.033203125, -8.046627044677734e-06, -0.0037097930908203125, -0.020172119140625, -0.0121307373046875, 0.036285400390625, -0.039642333984375, 0.0360107421875, 0.00848388671875, 0.06414794921875, -0.032562255859375, 0.0251312255859375, -0.005878448486328125, 0.0221099853515625, -0.02227783203125, 0.016265869140625, 0.007038116455078125, -0.01476287841796875, 0.071533203125, -0.024566650390625, -0.03021240234375, -0.002979278564453125, -0.0222015380859375, -0.014404296875, -0.004425048828125, -0.05523681640625, 0.0196075439453125, 0.0260009765625, 0.0179595947265625, -0.0443115234375, 0.050628662109375, 0.0176239013671875, 0.024688720703125, 0.04327392578125, -0.026824951171875, -0.021087646484375, 0.0027332305908203125, -0.00400543212890625, -0.0343017578125, -0.0006237030029296875, 0.0281219482421875, 0.00832366943359375, -0.0254058837890625, 0.0068206787109375, -0.01617431640625, -0.0250701904296875, -0.0085601806640625, -0.0171661376953125, -0.0137786865234375, 0.0096893310546875, 0.02032470703125, -0.0304718017578125, 0.06256103515625, -0.00667572021484375, -0.0121307373046875, -0.0638427734375, 0.0185394287109375, 0.03399658203125, -0.006771087646484375, -0.02227783203125, -0.01495361328125, 0.03765869140625, 0.00878143310546875, -0.01727294921875, -0.00971221923828125, 0.0254058837890625, -0.0096588134765625, -0.020294189453125, -0.01290130615234375, 0.02166748046875, 0.01849365234375, 0.046966552734375, 0.05084228515625, 0.0116119384765625, 0.0017633438110351562, -0.0206451416015625, -0.038726806640625, 0.0487060546875, 0.054290771484375, -0.0080108642578125, 0.0004127025604248047, -0.0024967193603515625, 0.06787109375, -0.005214691162109375, -0.025054931640625, 0.03155517578125, -0.006328582763671875, 0.0533447265625, -0.0439453125, 0.05474853515625, 0.0173187255859375, -0.0015926361083984375, 0.0123138427734375, -0.03125, -0.032012939453125, -0.051361083984375, -0.05096435546875, -0.0104522705078125, 0.0611572265625, 0.03717041015625, -0.01421356201171875, -0.0170745849609375, 0.0019931793212890625, -0.0280303955078125, -0.0169830322265625, -0.00646209716796875, -0.0270843505859375, -0.0025196075439453125, -0.1485595703125, -0.020233154296875, 0.009185791015625, -0.005828857421875, -0.06292724609375, -0.0243377685546875, -0.051666259765625, 0.005878448486328125, 0.007625579833984375, -0.02685546875, 0.06201171875, 0.01641845703125, 0.062744140625, -0.019012451171875, -0.026397705078125, 0.0078277587890625, 0.0173187255859375, 0.0015668869018554688, -0.02142333984375, 0.01016998291015625, -0.02008056640625, 0.037017822265625, 0.01479339599609375, 0.0107574462890625, 0.01385498046875, 0.0271148681640625, 0.00634765625, -0.0209503173828125, -0.0114593505859375, 0.0233306884765625, 0.02301025390625, 0.00952911376953125, 0.04180908203125, 0.00843048095703125, 0.0007023811340332031, -0.0242767333984375, -0.0029144287109375, 0.01184844970703125, 0.07513427734375, 0.01282501220703125, 0.041534423828125, -0.00019860267639160156, -0.0181427001953125, 0.04339599609375, -0.00579071044921875, 0.007251739501953125, -0.0016622543334960938, -0.010711669921875, -0.022613525390625, -0.0267181396484375, 0.0035114288330078125, 0.043792724609375, -0.0010881423950195312, -0.0246124267578125, -0.01342010498046875, 0.0120086669921875, 0.01531219482421875, -0.0027904510498046875, -0.0211029052734375, 0.0709228515625, -0.015899658203125, -0.0173797607421875, -0.0037860870361328125, -0.0158538818359375, -0.0394287109375, 0.0101165771484375, -0.060272216796875, 0.005130767822265625, -0.00244140625, -0.017974853515625, -0.0745849609375, -0.012481689453125, -0.027313232421875, -0.046417236328125, 0.0163726806640625, 0.01165008544921875, 0.01300048828125, -0.0291748046875, -0.01332855224609375, -0.025665283203125, 0.006565093994140625, -0.00495147705078125, 0.07037353515625, 0.0152435302734375, -0.0019989013671875, 0.038177490234375, -0.0147705078125, 0.0004940032958984375, -0.031158447265625, 0.0499267578125, -0.061981201171875, -0.00908660888671875, -0.018402099609375, -0.04461669921875, -0.0528564453125, -0.0223236083984375, -0.02972412109375, -0.016845703125, -0.04168701171875, -0.007022857666015625, -0.01068878173828125, -0.0269622802734375, 0.007778167724609375, -0.016326904296875, -0.036865234375, 0.0159912109375, -0.0220184326171875, -0.0285186767578125, 0.0165557861328125, 0.03375244140625, -0.0450439453125, -0.00482940673828125, 0.0066375732421875, -0.004505157470703125, -0.045562744140625, -0.021148681640625, -0.0020694732666015625, -0.0213623046875, -0.05194091796875, 0.0545654296875, 0.0175628662109375, 0.00522613525390625, 0.0289764404296875, -0.0176239013671875, 0.0118408203125, -0.0309906005859375, 0.0092010498046875, 0.01385498046875, 0.0263519287109375, 0.03411865234375, 0.03582763671875, -0.050994873046875, -0.04034423828125, 0.0140838623046875, -0.01080322265625, 0.0222015380859375, -0.051971435546875, 0.051544189453125, 0.0175018310546875, -0.0302886962890625, -0.007080078125, 0.0097808837890625, -0.018402099609375, 0.01236724853515625, -0.005939483642578125, -0.02215576171875, 0.0274505615234375, -0.00473785400390625, -0.03759765625, -0.01419830322265625, 0.04180908203125, -0.045562744140625, -0.0008344650268554688, -0.020843505859375, 0.033782958984375, -0.040252685546875, 0.05584716796875, 0.018768310546875, 0.038909912109375, 0.006916046142578125, 0.007129669189453125, -0.0430908203125, -0.00222015380859375, 0.01261138916015625, 0.01184844970703125, -0.01053619384765625, 0.002323150634765625, 0.0001367330551147461, -0.01557159423828125, 0.00469207763671875, 0.023223876953125, -0.0307159423828125, -0.00010949373245239258, -0.0299835205078125, 0.034698486328125, 0.01641845703125, -0.02154541015625, -0.068603515625, -0.006988525390625, 0.0034503936767578125, -0.0007004737854003906, 0.06585693359375, -0.01220703125, 0.00624847412109375, -0.00841522216796875, 0.06695556640625, -0.037078857421875, 0.034637451171875, 0.01175689697265625, 0.04156494140625, -0.00202178955078125, 0.021026611328125, -0.0017175674438476562, 0.00959014892578125, 0.017852783203125, -0.02166748046875, 0.0274810791015625, 0.0171051025390625, 0.014373779296875, 0.0269317626953125, -0.058990478515625, -0.0210113525390625, -0.035369873046875, -0.02069091796875, 0.00913238525390625, -0.03125, -0.032470703125, -0.0031280517578125, -0.01348114013671875, -0.01525115966796875, -0.004848480224609375, -0.0003123283386230469, -0.005828857421875, 0.0443115234375, 0.000850677490234375, -0.014556884765625, 0.00891876220703125, -0.030059814453125, -0.02117919921875, -0.021575927734375, -0.0194244384765625, 0.03863525390625, 0.00885009765625, 0.00921630859375, -0.0031566619873046875, -0.0487060546875, 0.0034084320068359375, 0.0115203857421875, -0.0120086669921875, -0.056427001953125, -0.03460693359375, -0.0033435821533203125, -0.0296783447265625, 0.04541015625, 0.00852203369140625, -0.007137298583984375, 0.01476287841796875, -0.037200927734375, 0.005397796630859375, 0.036041259765625, 0.0421142578125, -0.02349853515625, -0.026031494140625, -0.0251922607421875],
        topk=5
    )
    print(b)

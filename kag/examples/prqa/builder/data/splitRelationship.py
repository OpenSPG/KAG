import csv

# 定义分类字典（根据您提供的列表）
category_map = {
    "PersonWithPerson": ["学姐", "未婚夫", "外祖父", "妾", "姨夫", "堂伯父", "第三任妻子", "堂弟", "堂妹", "前男友", "外孙", "连襟", "义母", "叔父", "徒弟",
                         "妻姐", "堂哥", "前妻", "养女", "孙女", "外孙子", "曾外祖母", "第二任丈夫", "丈夫", "师弟", "大姨子", "岳母", "侄子", "妻子",
                         "小姑子", "好友", "表哥", "曾外孙子", "义父", "学妹", "亲家公", "第四任妻子", "生母", "老师", "队友", "姑姑", "姑父", "义妹",
                         "同门", "兄弟", "合作人", "表兄", "第一任妻子", "继母", "堂兄", "外甥", "女婿", "表侄", "师傅", "师姐", "堂小舅子", "庶子", "老板",
                         "前公公", "侄孙子", "侄孙媳妇", "弟子", "前儿媳", "叔外公", "师兄", "堂姐", "助理", "伯母", "曾孙子", "义兄", "外曾孙女", "生父",
                         "大姑子", "亲家母", "外曾孙子", "堂侄", "恩师", "舅母", "教练", "叔外祖父", "伯伯", "姨父", "婆婆", "妯娌", "导师", "亡妻", "同学",
                         "义子", "弟弟", "表弟", "学弟", "前任", "外甥女", "继子", "知己", "经纪人", "妹夫", "小舅子", "祖母", "师妹", "姑妈", "前队友",
                         "表叔", "表姑父", "大爷爷", "玄孙", "儿子", "姐夫", "堂舅", "第五任妻子", "大舅子", "前夫", "恋人", "对手", "偶像", "原配", "嫂子",
                         "大伯哥", "儿媳", "孙子", "男朋友", "爱人", "伯乐", "搭档", "师父", "学生", "旧爱", "外曾祖母", "女朋友", "先夫", "养父", "义弟",
                         "继父", "师祖", "外祖母", "表姐", "姑母", "外曾祖父", "妹妹", "岳父", "姨母", "曾外祖父", "云孙", "女儿", "朋友", "继女", "伴侣",
                         "嫡母", "未婚妻", "母亲", "养母", "舅父", "曾孙", "曾祖母", "侄孙", "学长", "父亲", "第二任妻子", "外甥女婿", "公公", "师爷", "挚爱",
                         "大舅哥", "奶奶", "外孙女", "第一任丈夫", "表姨", "侄女", "伯父", "小叔子", "义女", "婶母", "曾孙女", "叔叔", "第六任妻子", "小姨子",
                         "战友", "表妹", "养子", "曾祖父", "男友", "继任", "姐姐", "祖父", "前女友", "哥哥", "弟媳", "社长", "师生", "员工", "旗下艺人"],
    "PersonWithWork": ["编剧", "综艺节目", "作者", "主要作品", "摄影作品", "歌曲原唱", "主要配音", "代表作品", "音乐作品", "制作", "主要演员", "配音",
                       "文学作品", "登场作品", "主持", "主要角色", "音乐视频", "参演", "为他人创作音乐", "执导", "发行专辑"],
    "OrganizationWithOrganization": ["代表", "创办", "设立单位", "办学团体", "专职院士数", "相关国内联盟", "院系设置", "所属机构", "合作院校", "设立单位"],
    "PersonWithOrganization": ["领导", "现任领导", "历任领导", "成员", "毕业院校", "创始人", "法人", "知名人物", "现任领导"],
    "WorkWithOrganization": ["出版社", "连载平台"],
    "Others": ["类别", "经纪公司", "其他关系", "简称", "学校类别", "学校身份", "类型", "学校特色", "办学性质"]
}

# 读取 kg.txt
with open("kg.txt", "r", encoding="utf-8") as f:
    lines = [line.strip().split("\t") for line in f]

# 初始化 CSV 写入器
csv_files = {category: open(f"{category}.csv", "w", newline='', encoding="utf-8")
             for category in category_map}
writers = {category: csv.writer(csv_files[category])
           for category in category_map}

# 写入 CSV 头部
for category in category_map:
    writers[category].writerow(["头实体", "关系", "尾实体"])

# 分类并写入数据
for head, relation, tail in lines:
    for category, relations in category_map.items():
        if relation in relations:
            writers[category].writerow([head, relation, tail])
            break  # 确保一个关系只属于一个分类
    else:  # 未匹配到分类的关系
        writers["Others"].writerow([head, relation, tail])

# 关闭文件
for f in csv_files.values():
    f.close()